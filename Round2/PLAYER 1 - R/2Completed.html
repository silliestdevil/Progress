<!-- COMPLETED FACE TRACKING -->

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.9.3/p5.js"></script>
    <title>Completed</title>
</head>
<!-- no scroll and green background-->
<body style=" overflow-y: hidden;  overflow-x: hidden; background-color: rgb(34, 153, 84);">

    <script>
      let tryingToNavigate = false;
        let angle = 0; // Initial angle for drawing the circle
      
function setup() {
  createCanvas(windowWidth, windowHeight);
}

function draw() {
  background(34, 153, 84);
  drawCircle();
  drawCheckMark(width / 2, height / 2, 100);

  if (angle < TWO_PI) {
    angle += 0.05; // Increment angle for the next frame
  } else {
    circleDrawn(); // Check if the circle is completed
  }
}

function drawCheckMark(x, y, size) {
  // Calculate coordinates for the check mark lines
  let startX = x - size * 0.4;
  let startY = y;
  let midX = x - size * 0.05;
  let midY = y + size * 0.30;
  let endX = x + size * 0.45;
  let endY = y - size * 0.5;

  // Draw the check mark
  stroke(255);
  strokeWeight(10);
  noFill();
  beginShape();
  vertex(startX, startY);
  vertex(midX, midY);
  vertex(endX, endY);
  endShape();
}

function drawCircle() {
  let circleRadius = 100; // Radius of the circle
  let circleX = width / 2; // X-coordinate of the circle center
  let circleY = height / 2; // Y-coordinate of the circle center

  // Draw the circle
  noFill();
  stroke(255);
  strokeWeight(10);
  beginShape();
  for (let a = 0; a <= angle; a += 0.01) {
    let x = circleX + cos(a) * circleRadius;
    let y = circleY + sin(a) * circleRadius;
    vertex(x, y);
  }
  endShape();
}

function circleDrawn() {
  // Redirect to Single.html once the circle is fully drawn
  if (angle >= TWO_PI) {
    console.log('sending');

      setTimeout(() => {
        if (tryingToNavigate == false) //to make sure the html redirects as the next p5 sketch is drawn
        window.location.href = "Final_Color.html"; // Redirect after 3 seconds
        tryingToNavigate = true;
      }, 3000); // 3000 milliseconds = 3 seconds
  }
}

function checkForPlayer() {
    fetch("http://172.20.10.4:3000/colour", {
      method: "POST", // Post the R value again if others have connected to the server
      headers: {"Content-Type": "application/json"},
      body: JSON.stringify({colour: 'R', value: COMPLETE}),
    })
    fetch("http://172.20.10.4:3000/colour")
      .then(res => res.json())
      .then(res => {
        let objB = res.find(o => o.colour === 'R'); //if the B value is recieved 'colour: 'R', value: COMPLETE'
        let objG = res.find(o => o.colour === 'G'); //if the G value is recieved 'colour: 'G', value: COMPLETE'
        

        if (objB && objG)  {//B value recieved
          console.log(objB);
          setTimeout(() => {
            if (tryingToNavigate == false){//to make sure the html redirects as the next p5 sketch is drawn
            window.location.href = "Final_Colour.html"; // Redirect to SecondA1 after 3 seconds R and B colour output 
            tryingToNavigate = true;
        }
      }, 3000); // 3000 milliseconds = 3 seconds
    }}
      )}
        
      
    </script>
</body>
</html> 